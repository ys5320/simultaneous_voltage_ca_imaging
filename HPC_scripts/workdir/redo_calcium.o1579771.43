Original path: /rds/general/user/be320/projects/thefarm2/live/Firefly/Calcium_Voltage_Imaging/MDA_MB_468/20250127/slip3/20250127_slip3_area1_468/20250127_slip3_area1_exp3ms_4AP_5mM_1
Fixed path: /rds/general/user/ys5320/projects/thefarm2/live/Firefly/Calcium_Voltage_Imaging/MDA_MB_468/20250127/slip3/20250127_slip3_area1_468/20250127_slip3_area1_exp3ms_4AP_5mM_1
42 0
42 1
42 2
42 3
42 4
42 5
42 6
42 7
42 8
42 9
42 10
42 11
42 12
42 13
42 14
42 15
42 16
42 17
42 18
42 19
42 20
42 21
42 22
42 23
42 24
42 25
42 26
42 27
42 28
42 29
42 30
42 31
42 32
42 33
42 34
42 35
42 36
42 37
42 38
42 39
42 40
42 41
20250705_slip8_area1
['20250705_slip8_area1_TRAM-34_1uM_JEDIonly_1_MMStack_Default.ome.tif', '20250705_slip8_area1_TRAM-34_1uM_JEDIonly_1_MMStack_Default_1.ome.tif', '20250705_slip8_area1_TRAM-34_1uM_JEDIonly_1_MMStack_Default_2.ome.tif']
Loaded Z-stack shape: (20000, 512, 512)
(10000, 512, 512) (10000, 512, 512)
(10000, 512, 512) (10000, 512, 512)
✅ Saved enhanced_voltage_video.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250705_slip8_area1
✅ Saved enhanced_calcium_video.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250705_slip8_area1
42 43
42 44
42 45
42 46
42 47
42 48
42 49
42 50
42 51
42 52
42 53
42 54
42 55
42 56
42 57
42 58
42 59
42 60
42 61
42 62
42 63
42 64
42 65
42 66
42 67
42 68
42 0
42 1
42 2
42 3
42 4
42 5
42 6
42 7
42 8
42 9
42 10
42 11
42 12
42 13
42 14
42 15
42 16
42 17
42 18
42 19
42 20
42 21
42 22
42 23
42 24
42 25
42 26
42 27
42 28
42 29
42 30
42 31
42 32
42 33
42 34
42 35
42 36
42 37
42 38
42 39
42 40
42 41

Processing pipeline for trial: 20250705_slip8_area1
Processing trial: 20250705_slip8_area1
Voltage file: 20250705_slip8_area1_TRAM-34_1uM_JEDIonly_voltage_transfected.csv
Calcium file: 20250705_slip8_area1_TRAM-34_1uM_JEDIonly_ca_transfected.csv
--------------------------------------------------------------------------------
Loading voltage and calcium data...
Detected: full_experiment with 10000 datapoints
Detected: full_experiment with 10000 datapoints
Voltage cells: 30, Calcium cells: 30
=== FULL EXPERIMENT - USING SEGMENTATION ===
=== STEP 1: Normalization + High-Pass Filter to Full VOLTAGE Timeseries ===
Applying normalization to raw voltage data (before filtering)...
  - Min-max normalization applied to voltage (range: [-1, 1])
Applying high-pass filter to normalized voltage data (cutoff: 0.01 Hz)...
Normalization + High-pass filtering complete for voltage. Shape: (30, 10000)
=== STEP 1: Normalization + High-Pass Filter to Full CALCIUM Timeseries ===
Applying normalization to raw calcium data (before filtering)...
  - Min-max normalization applied to calcium (range: [-1, 1])
Applying high-pass filter to normalized calcium data (cutoff: 0.01 Hz)...
Normalization + High-pass filtering complete for calcium. Shape: (30, 10000)
=== STEP 2: Finding Consensus Timepoint from VOLTAGE data ===

=== Detection Consistency Analysis ===

Detection Consistency Analysis:
Total detections: 29
Time range: 15.72 - 18.17 min
Time span: 2.45 min
Standard deviation: 0.435 min
Median: 16.69 min

Detection time distribution (30-second bins):
  15.7-16.2 min: 2 detections
  16.2-16.7 min: 14 detections
  16.7-17.2 min: 11 detections
  17.7-18.2 min: 2 detections

=== Consensus Timepoint (MODE) ===
Found 29 total detections across channels
Detection times: ['16.64 min', '16.69 min', '16.68 min', '15.82 min', '16.69 min', '17.77 min', '16.76 min', '18.17 min', '16.69 min', '16.69 min', '16.58 min', '16.69 min', '16.76 min', '16.77 min', '16.78 min', '16.78 min', '16.61 min', '16.62 min', '16.64 min', '16.65 min', '17.00 min', '17.00 min', '16.73 min', '16.74 min', '16.75 min', '17.15 min', '16.70 min', '15.72 min', '16.49 min']
Consensus method: Mode group size = 24, time = 16.71 min

Consensus timepoint: 16.71 min (sample 5014)
Assigned consensus timepoint to all 30 channels
=== CREATING SEGMENT VIDEOS FOR 20250705_slip8_area1 ===
  Using TIFF files: ['20250705_slip8_area1_TRAM-34_1uM_JEDIonly_1_MMStack_Default.ome.tif', '20250705_slip8_area1_TRAM-34_1uM_JEDIonly_1_MMStack_Default_1.ome.tif', '20250705_slip8_area1_TRAM-34_1uM_JEDIonly_1_MMStack_Default_2.ome.tif']
  Loaded Z-stack shape: (20000, 512, 512)
  Deinterleaved shapes: V=(10000, 512, 512), Ca=(10000, 512, 512)
  Creating pre segment: frames 200-4814
✅ Saved pre_voltage_20250705_slip8_area1.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250705_slip8_area1
✅ Saved pre_calcium_20250705_slip8_area1.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250705_slip8_area1
  ✓ Created: pre_voltage_20250705_slip8_area1.avi & pre_calcium_20250705_slip8_area1.avi
  Creating post segment: frames 5414-9999
✅ Saved post_voltage_20250705_slip8_area1.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250705_slip8_area1
✅ Saved post_calcium_20250705_slip8_area1.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250705_slip8_area1
  ✓ Created: post_voltage_20250705_slip8_area1.avi & post_calcium_20250705_slip8_area1.avi
=== STEP 3: Segmenting High-Pass Filtered VOLTAGE Timeseries ===
Consensus timepoint: 5014 frames (16.71 min)
VOLTAGE PRE segment: frames 200-4814 (0.67-16.05 min)
  Shape: (30, 4615)
VOLTAGE POST segment: frames 5414-9999 (18.05-33.33 min)
  Shape: (30, 4586)
=== STEP 3: Segmenting High-Pass Filtered CALCIUM Timeseries ===
Consensus timepoint: 5014 frames (16.71 min)
CALCIUM PRE segment: frames 200-4814 (0.67-16.05 min)
  Shape: (30, 4615)
CALCIUM POST segment: frames 5414-9999 (18.05-33.33 min)
  Shape: (30, 4586)

=== PROCESSING VOLTAGE PRE SEGMENT ===
  - voltage Gaussian filtering applied (sigma=3)
  Voltage data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250705_slip8_area1/pre_voltage_TRAM-34_1uM_20250705_slip8_area1.csv
  Voltage RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250705_slip8_area1/pre_voltage_TRAM-34_1uM_20250705_slip8_area1_raw.csv

=== PROCESSING CALCIUM PRE SEGMENT ===
  - calcium Gaussian filtering applied (sigma=3)
  Calcium data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250705_slip8_area1/pre_calcium_TRAM-34_1uM_20250705_slip8_area1.csv
  Calcium RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250705_slip8_area1/pre_calcium_TRAM-34_1uM_20250705_slip8_area1_raw.csv

=== PROCESSING VOLTAGE POST SEGMENT ===
  - voltage Gaussian filtering applied (sigma=3)
  Voltage data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250705_slip8_area1/post_voltage_TRAM-34_1uM_20250705_slip8_area1.csv
  Voltage RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250705_slip8_area1/post_voltage_TRAM-34_1uM_20250705_slip8_area1_raw.csv

=== PROCESSING CALCIUM POST SEGMENT ===
  - calcium Gaussian filtering applied (sigma=3)
  Calcium data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250705_slip8_area1/post_calcium_TRAM-34_1uM_20250705_slip8_area1.csv
  Calcium RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250705_slip8_area1/post_calcium_TRAM-34_1uM_20250705_slip8_area1_raw.csv

=== VOLTAGE EVENT DETECTION ===
Using FIXED STD voltage event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting voltage events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
  - Applying full morphological filtering for voltage channel 12
  - Applying full morphological filtering for voltage channel 13
  - Applying full morphological filtering for voltage channel 14
  - Applying full morphological filtering for voltage channel 15
  - Applying full morphological filtering for voltage channel 16
  - Applying full morphological filtering for voltage channel 17
  - Applying full morphological filtering for voltage channel 18
  - Applying full morphological filtering for voltage channel 19
  - Applying full morphological filtering for voltage channel 20
  - Applying full morphological filtering for voltage channel 21
  - Applying full morphological filtering for voltage channel 22
  - Applying full morphological filtering for voltage channel 23
  - Applying full morphological filtering for voltage channel 24
  - Applying full morphological filtering for voltage channel 25
  - Applying full morphological filtering for voltage channel 26
  - Applying full morphological filtering for voltage channel 27
  - Applying full morphological filtering for voltage channel 28
  - Applying full morphological filtering for voltage channel 29
Detected 197 voltage events using fixed_std (fixed=0.0600)
  Removed 9 duplicate voltage events

=== FILTERING BLEACHING ARTIFACTS: VOLTAGE PRE SEGMENT ===
Filtering bleaching artifacts for voltage (≥5 cells, 70% overlap, start <10.0s)...
  Original voltage events: 188
  Excluded bleaching artifacts: 0
  Remaining voltage events: 188

=== FILTERING SIMULTANEOUS EVENTS: VOLTAGE PRE SEGMENT ===
Filtering simultaneous voltage events (max 999 cells, 50% overlap)...
  Original voltage events: 188
  Filtered voltage events: 188
  Excluded voltage events: 0
FIXED: Using per-channel baselines + fixed STD threshold for voltage visualization...
  Fixed voltage std: 0.0600
  Fixed voltage threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED voltage plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/pre_voltage_TRAM-34_1uM_20250705_slip8_area1_events_perchannel_fixed.png
Using FIXED STD voltage event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting voltage events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
  - Applying full morphological filtering for voltage channel 12
  - Applying full morphological filtering for voltage channel 13
  - Applying full morphological filtering for voltage channel 14
  - Applying full morphological filtering for voltage channel 15
  - Applying full morphological filtering for voltage channel 16
  - Applying full morphological filtering for voltage channel 17
  - Applying full morphological filtering for voltage channel 18
  - Applying full morphological filtering for voltage channel 19
  - Applying full morphological filtering for voltage channel 20
  - Applying full morphological filtering for voltage channel 21
  - Applying full morphological filtering for voltage channel 22
  - Applying full morphological filtering for voltage channel 23
  - Applying full morphological filtering for voltage channel 24
  - Applying full morphological filtering for voltage channel 25
  - Applying full morphological filtering for voltage channel 26
  - Applying full morphological filtering for voltage channel 27
  - Applying full morphological filtering for voltage channel 28
  - Applying full morphological filtering for voltage channel 29
Detected 159 voltage events using fixed_std (fixed=0.0600)
  Removed 11 duplicate voltage events

=== FILTERING BLEACHING ARTIFACTS: VOLTAGE POST SEGMENT ===
Filtering bleaching artifacts for voltage (≥5 cells, 70% overlap, start <10.0s)...
  Original voltage events: 148
  Excluded bleaching artifacts: 0
  Remaining voltage events: 148

=== FILTERING SIMULTANEOUS EVENTS: VOLTAGE POST SEGMENT ===
Filtering simultaneous voltage events (max 999 cells, 50% overlap)...
  Original voltage events: 148
  Filtered voltage events: 148
  Excluded voltage events: 0
FIXED: Using per-channel baselines + fixed STD threshold for voltage visualization...
  Fixed voltage std: 0.0600
  Fixed voltage threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED voltage plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/post_voltage_TRAM-34_1uM_20250705_slip8_area1_events_perchannel_fixed.png
Enhanced filtered voltage events saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250705_slip8_area1/events_voltage_TRAM-34_1uM_20250705_slip8_area1_fixed_std_adaptive_filtered.csv

FIXED STD VOLTAGE Event Summary for TRAM-34_1uM 20250705_slip8_area1:
  Total filtered events: 336
  Total excluded events: 0 (50% rule)
  Pre-segment events: 188
  Post-segment events: 148
  Duration stats: mean=25.60s, median=23.40s

=== CALCIUM EVENT DETECTION ===
Using FIXED STD calcium event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting calcium events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
  - Applying full morphological filtering for voltage channel 12
  - Applying full morphological filtering for voltage channel 13
  - Applying full morphological filtering for voltage channel 14
  - Applying full morphological filtering for voltage channel 15
  - Applying full morphological filtering for voltage channel 16
  - Applying full morphological filtering for voltage channel 17
  - Applying full morphological filtering for voltage channel 18
  - Applying full morphological filtering for voltage channel 19
  - Applying full morphological filtering for voltage channel 20
  - Applying full morphological filtering for voltage channel 21
  - Applying full morphological filtering for voltage channel 22
  - Applying full morphological filtering for voltage channel 23
  - Applying full morphological filtering for voltage channel 24
  - Applying full morphological filtering for voltage channel 25
  - Applying full morphological filtering for voltage channel 26
  - Applying full morphological filtering for voltage channel 27
  - Applying full morphological filtering for voltage channel 28
  - Applying full morphological filtering for voltage channel 29
Detected 10 calcium events using fixed_std (fixed=0.0600)

=== FILTERING BLEACHING ARTIFACTS: CALCIUM PRE SEGMENT ===
Filtering bleaching artifacts for calcium (≥5 cells, 70% overlap, start <10.0s)...
  Original calcium events: 10
  Excluded bleaching artifacts: 0
  Remaining calcium events: 10

=== FILTERING SIMULTANEOUS EVENTS: CALCIUM PRE SEGMENT ===
Filtering simultaneous calcium events (max 999 cells, 50% overlap)...
  Original calcium events: 10
  Filtered calcium events: 10
  Excluded calcium events: 0
FIXED: Using per-channel baselines + fixed STD threshold for calcium visualization...
  Fixed calcium std: 0.0600
  Fixed calcium threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED calcium plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/pre_calcium_TRAM-34_1uM_20250705_slip8_area1_events_perchannel_fixed.png
Using FIXED STD calcium event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting calcium events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
  - Applying full morphological filtering for voltage channel 12
  - Applying full morphological filtering for voltage channel 13
  - Applying full morphological filtering for voltage channel 14
  - Applying full morphological filtering for voltage channel 15
  - Applying full morphological filtering for voltage channel 16
  - Applying full morphological filtering for voltage channel 17
  - Applying full morphological filtering for voltage channel 18
  - Applying full morphological filtering for voltage channel 19
  - Applying full morphological filtering for voltage channel 20
  - Applying full morphological filtering for voltage channel 21
  - Applying full morphological filtering for voltage channel 22
  - Applying full morphological filtering for voltage channel 23
  - Applying full morphological filtering for voltage channel 24
  - Applying full morphological filtering for voltage channel 25
  - Applying full morphological filtering for voltage channel 26
  - Applying full morphological filtering for voltage channel 27
  - Applying full morphological filtering for voltage channel 28
  - Applying full morphological filtering for voltage channel 29
Detected 42 calcium events using fixed_std (fixed=0.0600)

=== FILTERING BLEACHING ARTIFACTS: CALCIUM POST SEGMENT ===
Filtering bleaching artifacts for calcium (≥5 cells, 70% overlap, start <10.0s)...
  Original calcium events: 42
  Excluded bleaching artifacts: 0
  Remaining calcium events: 42

=== FILTERING SIMULTANEOUS EVENTS: CALCIUM POST SEGMENT ===
Filtering simultaneous calcium events (max 999 cells, 50% overlap)...
  Original calcium events: 42
  Filtered calcium events: 42
  Excluded calcium events: 0
FIXED: Using per-channel baselines + fixed STD threshold for calcium visualization...
  Fixed calcium std: 0.0600
  Fixed calcium threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED calcium plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/post_calcium_TRAM-34_1uM_20250705_slip8_area1_events_perchannel_fixed.png
Enhanced filtered calcium events saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250705_slip8_area1/events_calcium_TRAM-34_1uM_20250705_slip8_area1_fixed_std_adaptive_filtered.csv

FIXED STD CALCIUM Event Summary for TRAM-34_1uM 20250705_slip8_area1:
  Total filtered events: 52
  Total excluded events: 0 (50% rule)
  Pre-segment events: 10
  Post-segment events: 42
  Duration stats: mean=20.66s, median=20.70s
✓ Pipeline completed for 20250705_slip8_area1
42 43
42 44
42 45
42 46
42 47
42 48
42 49
42 50
42 51
42 52
42 53
42 54
42 55
42 56
42 57
42 58
42 59
42 60
42 61
42 62
42 63
42 64
42 65
42 66
42 67
42 68

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        64            32
 Used       :        16 (peak)  27.93 (ave)

============================================
