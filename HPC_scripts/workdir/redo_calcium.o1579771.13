Original path: /rds/general/user/be320/projects/thefarm2/live/Firefly/Calcium_Voltage_Imaging/MDA_MB_468/20250127/slip3/20250127_slip3_area1_468/20250127_slip3_area1_exp3ms_4AP_5mM_1
Fixed path: /rds/general/user/ys5320/projects/thefarm2/live/Firefly/Calcium_Voltage_Imaging/MDA_MB_468/20250127/slip3/20250127_slip3_area1_468/20250127_slip3_area1_exp3ms_4AP_5mM_1
12 0
12 1
12 2
12 3
12 4
12 5
12 6
12 7
12 8
12 9
12 10
12 11
20250304_slip1_area1
['20250304_slip1_area1_Ca_free_post_1_MMStack_Default.ome.tif', '20250304_slip1_area1_Ca_free_post_1_MMStack_Default_1.ome.tif']
Loaded Z-stack shape: (10000, 512, 512)
(5000, 512, 512) (5000, 512, 512)
(5000, 512, 512) (5000, 512, 512)
✅ Saved enhanced_voltage_video.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250304_slip1_area1
✅ Saved enhanced_calcium_video.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250304_slip1_area1
12 13
12 14
12 15
12 16
12 17
12 18
12 19
12 20
12 21
12 22
12 23
12 24
12 25
12 26
12 27
12 28
12 29
12 30
12 31
12 32
12 33
12 34
12 35
12 36
12 37
12 38
12 39
12 40
12 41
12 42
12 43
12 44
12 45
12 46
12 47
12 48
12 49
12 50
12 51
12 52
12 53
12 54
12 55
12 56
12 57
12 58
12 59
12 60
12 61
12 62
12 63
12 64
12 65
12 66
12 67
12 68
12 0
12 1
12 2
12 3
12 4
12 5
12 6
12 7
12 8
12 9
12 10
12 11

Processing pipeline for trial: 20250304_slip1_area1_post
Processing trial: 20250304_slip1_area1_post
Voltage file: 20250304_slip1_area1_Ca_free_post_voltage_transfected.csv
Calcium file: 20250304_slip1_area1_Ca_free_post_ca_transfected.csv
--------------------------------------------------------------------------------
Loading voltage and calcium data...
Detected: post_only with 5000 datapoints
Detected: post_only with 5000 datapoints
Voltage cells: 53, Calcium cells: 53
=== POST-ONLY FILES - SKIPPING SEGMENTATION ===
=== STEP 1: Normalization + High-Pass Filter to Full VOLTAGE Timeseries ===
Applying normalization to raw voltage data (before filtering)...
  - Min-max normalization applied to voltage (range: [-1, 1])
Applying high-pass filter to normalized voltage data (cutoff: 0.01 Hz)...
Normalization + High-pass filtering complete for voltage. Shape: (53, 5000)
=== STEP 1: Normalization + High-Pass Filter to Full CALCIUM Timeseries ===
Applying normalization to raw calcium data (before filtering)...
  - Min-max normalization applied to calcium (range: [-1, 1])
Applying high-pass filter to normalized calcium data (cutoff: 0.01 Hz)...
Normalization + High-pass filtering complete for calcium. Shape: (53, 5000)
  - voltage Gaussian filtering applied (sigma=3)
  Voltage data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip1_area1_post/post_voltage_unknown_20250304_slip1_area1_post.csv
  Voltage RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip1_area1_post/post_voltage_unknown_20250304_slip1_area1_post_raw.csv
  - calcium Gaussian filtering applied (sigma=3)
  Calcium data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip1_area1_post/post_calcium_unknown_20250304_slip1_area1_post.csv
  Calcium RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip1_area1_post/post_calcium_unknown_20250304_slip1_area1_post_raw.csv
=== CREATING POST-ONLY VIDEO ===
=== CREATING POST-ONLY VIDEOS FOR 20250304_slip1_area1_post ===
  Using TIFF files: ['20250304_slip1_area1_Ca_free_post_1_MMStack_Default.ome.tif', '20250304_slip1_area1_Ca_free_post_1_MMStack_Default_1.ome.tif']
  Loaded Z-stack shape: (10000, 512, 512)
  Deinterleaved shapes: V=(5000, 512, 512), Ca=(5000, 512, 512)
  Creating post-only videos: entire recording (frames 0-4999)
✅ Saved post_voltage_20250304_slip1_area1_post.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip1_area1_post
✅ Saved post_calcium_20250304_slip1_area1_post.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip1_area1_post
  ✓ Created post-only videos: post_voltage_20250304_slip1_area1_post.avi & post_calcium_20250304_slip1_area1_post.avi

=== VOLTAGE EVENT DETECTION ===
Using FIXED STD voltage event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting voltage events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
  - Applying full morphological filtering for voltage channel 12
  - Applying full morphological filtering for voltage channel 13
  - Applying full morphological filtering for voltage channel 14
  - Applying full morphological filtering for voltage channel 15
  - Applying full morphological filtering for voltage channel 16
  - Applying full morphological filtering for voltage channel 17
  - Applying full morphological filtering for voltage channel 18
  - Applying full morphological filtering for voltage channel 19
  - Applying full morphological filtering for voltage channel 20
  - Applying full morphological filtering for voltage channel 21
  - Applying full morphological filtering for voltage channel 22
  - Applying full morphological filtering for voltage channel 23
  - Applying full morphological filtering for voltage channel 24
  - Applying full morphological filtering for voltage channel 25
  - Applying full morphological filtering for voltage channel 26
  - Applying full morphological filtering for voltage channel 27
  - Applying full morphological filtering for voltage channel 28
  - Applying full morphological filtering for voltage channel 29
  - Applying full morphological filtering for voltage channel 30
  - Applying full morphological filtering for voltage channel 31
  - Applying full morphological filtering for voltage channel 32
  - Applying full morphological filtering for voltage channel 33
  - Applying full morphological filtering for voltage channel 34
  - Applying full morphological filtering for voltage channel 35
  - Applying full morphological filtering for voltage channel 36
  - Applying full morphological filtering for voltage channel 37
  - Applying full morphological filtering for voltage channel 38
  - Applying full morphological filtering for voltage channel 39
  - Applying full morphological filtering for voltage channel 40
  - Applying full morphological filtering for voltage channel 41
  - Applying full morphological filtering for voltage channel 42
  - Applying full morphological filtering for voltage channel 43
  - Applying full morphological filtering for voltage channel 44
  - Applying full morphological filtering for voltage channel 45
  - Applying full morphological filtering for voltage channel 46
  - Applying full morphological filtering for voltage channel 47
  - Applying full morphological filtering for voltage channel 48
  - Applying full morphological filtering for voltage channel 49
  - Applying full morphological filtering for voltage channel 50
  - Applying full morphological filtering for voltage channel 51
  - Applying full morphological filtering for voltage channel 52
Detected 403 voltage events using fixed_std (fixed=0.0600)
  Removed 34 duplicate voltage events

=== FILTERING BLEACHING ARTIFACTS: VOLTAGE POST SEGMENT ===
Filtering bleaching artifacts for voltage (≥5 cells, 70% overlap, start <10.0s)...
  Found 53 negative bleaching events (cells: [0, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1], times: 0.0-0.2s)
  Original voltage events: 369
  Excluded bleaching artifacts: 53
  Remaining voltage events: 316

=== FILTERING SIMULTANEOUS EVENTS: VOLTAGE POST SEGMENT ===
Filtering simultaneous voltage events (max 999 cells, 50% overlap)...
  Original voltage events: 316
  Filtered voltage events: 316
  Excluded voltage events: 0
FIXED: Using per-channel baselines + fixed STD threshold for voltage visualization...
  Fixed voltage std: 0.0600
  Fixed voltage threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED voltage plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/post_voltage_unknown_20250304_slip1_area1_post_events_perchannel_fixed.png
Enhanced filtered voltage events saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip1_area1_post/events_voltage_unknown_20250304_slip1_area1_post_fixed_std_adaptive_filtered.csv

FIXED STD VOLTAGE Event Summary for unknown 20250304_slip1_area1_post:
  Total filtered events: 316
  Total excluded events: 53 (50% rule)
  Pre-segment events: 0
  Post-segment events: 316
  Duration stats: mean=30.24s, median=29.90s

=== CALCIUM EVENT DETECTION ===
Using FIXED STD calcium event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting calcium events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
  - Applying full morphological filtering for voltage channel 12
  - Applying full morphological filtering for voltage channel 13
  - Applying full morphological filtering for voltage channel 14
  - Applying full morphological filtering for voltage channel 15
  - Applying full morphological filtering for voltage channel 16
  - Applying full morphological filtering for voltage channel 17
  - Applying full morphological filtering for voltage channel 18
  - Applying full morphological filtering for voltage channel 19
  - Applying full morphological filtering for voltage channel 20
  - Applying full morphological filtering for voltage channel 21
  - Applying full morphological filtering for voltage channel 22
  - Applying full morphological filtering for voltage channel 23
  - Applying full morphological filtering for voltage channel 24
  - Applying full morphological filtering for voltage channel 25
  - Applying full morphological filtering for voltage channel 26
  - Applying full morphological filtering for voltage channel 27
  - Applying full morphological filtering for voltage channel 28
  - Applying full morphological filtering for voltage channel 29
  - Applying full morphological filtering for voltage channel 30
  - Applying full morphological filtering for voltage channel 31
  - Applying full morphological filtering for voltage channel 32
  - Applying full morphological filtering for voltage channel 33
  - Applying full morphological filtering for voltage channel 34
  - Applying full morphological filtering for voltage channel 35
  - Applying full morphological filtering for voltage channel 36
  - Applying full morphological filtering for voltage channel 37
  - Applying full morphological filtering for voltage channel 38
  - Applying full morphological filtering for voltage channel 39
  - Applying full morphological filtering for voltage channel 40
  - Applying full morphological filtering for voltage channel 41
  - Applying full morphological filtering for voltage channel 42
  - Applying full morphological filtering for voltage channel 43
  - Applying full morphological filtering for voltage channel 44
  - Applying full morphological filtering for voltage channel 45
  - Applying full morphological filtering for voltage channel 46
  - Applying full morphological filtering for voltage channel 47
  - Applying full morphological filtering for voltage channel 48
  - Applying full morphological filtering for voltage channel 49
  - Applying full morphological filtering for voltage channel 50
  - Applying full morphological filtering for voltage channel 51
  - Applying full morphological filtering for voltage channel 52
Detected 657 calcium events using fixed_std (fixed=0.0600)
  Removed 49 duplicate calcium events

=== FILTERING BLEACHING ARTIFACTS: CALCIUM POST SEGMENT ===
Filtering bleaching artifacts for calcium (≥5 cells, 70% overlap, start <10.0s)...
  Original calcium events: 608
  Excluded bleaching artifacts: 0
  Remaining calcium events: 608

=== FILTERING SIMULTANEOUS EVENTS: CALCIUM POST SEGMENT ===
Filtering simultaneous calcium events (max 999 cells, 50% overlap)...
  Original calcium events: 608
  Filtered calcium events: 608
  Excluded calcium events: 0
FIXED: Using per-channel baselines + fixed STD threshold for calcium visualization...
  Fixed calcium std: 0.0600
  Fixed calcium threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED calcium plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/post_calcium_unknown_20250304_slip1_area1_post_events_perchannel_fixed.png
Enhanced filtered calcium events saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip1_area1_post/events_calcium_unknown_20250304_slip1_area1_post_fixed_std_adaptive_filtered.csv

FIXED STD CALCIUM Event Summary for unknown 20250304_slip1_area1_post:
  Total filtered events: 608
  Total excluded events: 0 (50% rule)
  Pre-segment events: 0
  Post-segment events: 608
  Duration stats: mean=24.38s, median=22.70s
✓ Pipeline completed for 20250304_slip1_area1
12 13
12 14
12 15
12 16
12 17
12 18
12 19
12 20
12 21
12 22
12 23
12 24
12 25
12 26
12 27
12 28
12 29
12 30
12 31
12 32
12 33
12 34
12 35
12 36
12 37
12 38
12 39
12 40
12 41
12 42
12 43
12 44
12 45
12 46
12 47
12 48
12 49
12 50
12 51
12 52
12 53
12 54
12 55
12 56
12 57
12 58
12 59
12 60
12 61
12 62
12 63
12 64
12 65
12 66
12 67
12 68

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        64            32
 Used       :         7 (peak)  15.76 (ave)

============================================
