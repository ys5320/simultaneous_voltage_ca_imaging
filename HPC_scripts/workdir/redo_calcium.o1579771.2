Original path: /rds/general/user/be320/projects/thefarm2/live/Firefly/Calcium_Voltage_Imaging/MDA_MB_468/20250127/slip3/20250127_slip3_area1_468/20250127_slip3_area1_exp3ms_4AP_5mM_1
Fixed path: /rds/general/user/ys5320/projects/thefarm2/live/Firefly/Calcium_Voltage_Imaging/MDA_MB_468/20250127/slip3/20250127_slip3_area1_468/20250127_slip3_area1_exp3ms_4AP_5mM_1
1 0
20250128_slip1_area5
['20250128_slip1_area5_exp3ms_4AP_5mM_1_MMStack_Default.ome.tif', '20250128_slip1_area5_exp3ms_4AP_5mM_1_MMStack_Default_1.ome.tif', '20250128_slip1_area5_exp3ms_4AP_5mM_1_MMStack_Default_2.ome.tif']
Loaded Z-stack shape: (20000, 512, 512)
(10000, 512, 512) (10000, 512, 512)
(10000, 512, 512) (10000, 512, 512)
✅ Saved enhanced_voltage_video.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250128_slip1_area5
✅ Saved enhanced_calcium_video.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250128_slip1_area5
1 2
1 3
1 4
1 5
1 6
1 7
1 8
1 9
1 10
1 11
1 12
1 13
1 14
1 15
1 16
1 17
1 18
1 19
1 20
1 21
1 22
1 23
1 24
1 25
1 26
1 27
1 28
1 29
1 30
1 31
1 32
1 33
1 34
1 35
1 36
1 37
1 38
1 39
1 40
1 41
1 42
1 43
1 44
1 45
1 46
1 47
1 48
1 49
1 50
1 51
1 52
1 53
1 54
1 55
1 56
1 57
1 58
1 59
1 60
1 61
1 62
1 63
1 64
1 65
1 66
1 67
1 68
1 0

Processing pipeline for trial: 20250128_slip1_area5
Processing trial: 20250128_slip1_area5
Voltage file: 20250128_slip1_area5_exp3ms_4AP_5mM_voltage_transfected.csv
Calcium file: 20250128_slip1_area5_exp3ms_4AP_5mM_ca_transfected.csv
--------------------------------------------------------------------------------
Loading voltage and calcium data...
Detected: full_experiment with 10000 datapoints
Detected: full_experiment with 10000 datapoints
Voltage cells: 16, Calcium cells: 16
=== FULL EXPERIMENT - USING SEGMENTATION ===
=== STEP 1: Normalization + High-Pass Filter to Full VOLTAGE Timeseries ===
Applying normalization to raw voltage data (before filtering)...
  - Min-max normalization applied to voltage (range: [-1, 1])
Applying high-pass filter to normalized voltage data (cutoff: 0.01 Hz)...
Normalization + High-pass filtering complete for voltage. Shape: (16, 10000)
=== STEP 1: Normalization + High-Pass Filter to Full CALCIUM Timeseries ===
Applying normalization to raw calcium data (before filtering)...
  - Min-max normalization applied to calcium (range: [-1, 1])
Applying high-pass filter to normalized calcium data (cutoff: 0.01 Hz)...
Normalization + High-pass filtering complete for calcium. Shape: (16, 10000)
=== STEP 2: Finding Consensus Timepoint from VOLTAGE data ===

=== Detection Consistency Analysis ===

Detection Consistency Analysis:
Total detections: 16
Time range: 17.27 - 17.74 min
Time span: 0.47 min
Standard deviation: 0.110 min
Median: 17.30 min

Detection time distribution (30-second bins):
  17.3-17.8 min: 16 detections

=== Consensus Timepoint (MODE) ===
Found 16 total detections across channels
Detection times: ['17.28 min', '17.29 min', '17.37 min', '17.29 min', '17.42 min', '17.36 min', '17.31 min', '17.29 min', '17.33 min', '17.34 min', '17.29 min', '17.40 min', '17.29 min', '17.30 min', '17.74 min', '17.27 min']
Consensus method: Mode group size = 16, time = 17.35 min

Consensus timepoint: 17.35 min (sample 5204)
Assigned consensus timepoint to all 16 channels
=== CREATING SEGMENT VIDEOS FOR 20250128_slip1_area5 ===
  Using TIFF files: ['20250128_slip1_area5_exp3ms_4AP_5mM_1_MMStack_Default.ome.tif', '20250128_slip1_area5_exp3ms_4AP_5mM_1_MMStack_Default_1.ome.tif', '20250128_slip1_area5_exp3ms_4AP_5mM_1_MMStack_Default_2.ome.tif']
  Loaded Z-stack shape: (20000, 512, 512)
  Deinterleaved shapes: V=(10000, 512, 512), Ca=(10000, 512, 512)
  Creating pre segment: frames 200-5004
✅ Saved pre_voltage_20250128_slip1_area5.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip1_area5
✅ Saved pre_calcium_20250128_slip1_area5.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip1_area5
  ✓ Created: pre_voltage_20250128_slip1_area5.avi & pre_calcium_20250128_slip1_area5.avi
  Creating post segment: frames 5604-9999
✅ Saved post_voltage_20250128_slip1_area5.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip1_area5
✅ Saved post_calcium_20250128_slip1_area5.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip1_area5
  ✓ Created: post_voltage_20250128_slip1_area5.avi & post_calcium_20250128_slip1_area5.avi
=== STEP 3: Segmenting High-Pass Filtered VOLTAGE Timeseries ===
Consensus timepoint: 5204 frames (17.35 min)
VOLTAGE PRE segment: frames 200-5004 (0.67-16.68 min)
  Shape: (16, 4805)
VOLTAGE POST segment: frames 5604-9999 (18.68-33.33 min)
  Shape: (16, 4396)
=== STEP 3: Segmenting High-Pass Filtered CALCIUM Timeseries ===
Consensus timepoint: 5204 frames (17.35 min)
CALCIUM PRE segment: frames 200-5004 (0.67-16.68 min)
  Shape: (16, 4805)
CALCIUM POST segment: frames 5604-9999 (18.68-33.33 min)
  Shape: (16, 4396)

=== PROCESSING VOLTAGE PRE SEGMENT ===
  - voltage Gaussian filtering applied (sigma=3)
  Voltage data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip1_area5/pre_voltage_unknown_20250128_slip1_area5.csv
  Voltage RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip1_area5/pre_voltage_unknown_20250128_slip1_area5_raw.csv

=== PROCESSING CALCIUM PRE SEGMENT ===
  - calcium Gaussian filtering applied (sigma=3)
  Calcium data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip1_area5/pre_calcium_unknown_20250128_slip1_area5.csv
  Calcium RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip1_area5/pre_calcium_unknown_20250128_slip1_area5_raw.csv

=== PROCESSING VOLTAGE POST SEGMENT ===
  - voltage Gaussian filtering applied (sigma=3)
  Voltage data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip1_area5/post_voltage_unknown_20250128_slip1_area5.csv
  Voltage RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip1_area5/post_voltage_unknown_20250128_slip1_area5_raw.csv

=== PROCESSING CALCIUM POST SEGMENT ===
  - calcium Gaussian filtering applied (sigma=3)
  Calcium data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip1_area5/post_calcium_unknown_20250128_slip1_area5.csv
  Calcium RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip1_area5/post_calcium_unknown_20250128_slip1_area5_raw.csv

=== VOLTAGE EVENT DETECTION ===
Using FIXED STD voltage event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting voltage events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
  - Applying full morphological filtering for voltage channel 12
  - Applying full morphological filtering for voltage channel 13
  - Applying full morphological filtering for voltage channel 14
  - Applying full morphological filtering for voltage channel 15
Detected 14 voltage events using fixed_std (fixed=0.0600)
  Removed 2 duplicate voltage events

=== FILTERING BLEACHING ARTIFACTS: VOLTAGE PRE SEGMENT ===
Filtering bleaching artifacts for voltage (≥5 cells, 70% overlap, start <10.0s)...
  Original voltage events: 12
  Excluded bleaching artifacts: 0
  Remaining voltage events: 12

=== FILTERING SIMULTANEOUS EVENTS: VOLTAGE PRE SEGMENT ===
Filtering simultaneous voltage events (max 999 cells, 50% overlap)...
  Original voltage events: 12
  Filtered voltage events: 12
  Excluded voltage events: 0
FIXED: Using per-channel baselines + fixed STD threshold for voltage visualization...
  Fixed voltage std: 0.0600
  Fixed voltage threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED voltage plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/pre_voltage_unknown_20250128_slip1_area5_events_perchannel_fixed.png
Using FIXED STD voltage event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting voltage events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
  - Applying full morphological filtering for voltage channel 12
  - Applying full morphological filtering for voltage channel 13
  - Applying full morphological filtering for voltage channel 14
  - Applying full morphological filtering for voltage channel 15
Detected 7 voltage events using fixed_std (fixed=0.0600)

=== FILTERING BLEACHING ARTIFACTS: VOLTAGE POST SEGMENT ===
Filtering bleaching artifacts for voltage (≥5 cells, 70% overlap, start <10.0s)...
  Original voltage events: 7
  Excluded bleaching artifacts: 0
  Remaining voltage events: 7

=== FILTERING SIMULTANEOUS EVENTS: VOLTAGE POST SEGMENT ===
Filtering simultaneous voltage events (max 999 cells, 50% overlap)...
  Original voltage events: 7
  Filtered voltage events: 7
  Excluded voltage events: 0
FIXED: Using per-channel baselines + fixed STD threshold for voltage visualization...
  Fixed voltage std: 0.0600
  Fixed voltage threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED voltage plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/post_voltage_unknown_20250128_slip1_area5_events_perchannel_fixed.png
Enhanced filtered voltage events saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip1_area5/events_voltage_unknown_20250128_slip1_area5_fixed_std_adaptive_filtered.csv

FIXED STD VOLTAGE Event Summary for unknown 20250128_slip1_area5:
  Total filtered events: 19
  Total excluded events: 0 (50% rule)
  Pre-segment events: 12
  Post-segment events: 7
  Duration stats: mean=28.73s, median=23.80s

=== CALCIUM EVENT DETECTION ===
Using FIXED STD calcium event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting calcium events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
  - Applying full morphological filtering for voltage channel 12
  - Applying full morphological filtering for voltage channel 13
  - Applying full morphological filtering for voltage channel 14
  - Applying full morphological filtering for voltage channel 15
Detected 3 calcium events using fixed_std (fixed=0.0600)

=== FILTERING BLEACHING ARTIFACTS: CALCIUM PRE SEGMENT ===
Filtering bleaching artifacts for calcium (≥5 cells, 70% overlap, start <10.0s)...
  Original calcium events: 3
  Excluded bleaching artifacts: 0
  Remaining calcium events: 3

=== FILTERING SIMULTANEOUS EVENTS: CALCIUM PRE SEGMENT ===
Filtering simultaneous calcium events (max 999 cells, 50% overlap)...
  Original calcium events: 3
  Filtered calcium events: 3
  Excluded calcium events: 0
FIXED: Using per-channel baselines + fixed STD threshold for calcium visualization...
  Fixed calcium std: 0.0600
  Fixed calcium threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED calcium plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/pre_calcium_unknown_20250128_slip1_area5_events_perchannel_fixed.png
Using FIXED STD calcium event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting calcium events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
  - Applying full morphological filtering for voltage channel 12
  - Applying full morphological filtering for voltage channel 13
  - Applying full morphological filtering for voltage channel 14
  - Applying full morphological filtering for voltage channel 15
Detected 0 calcium events using fixed_std (fixed=0.0600)

=== FILTERING BLEACHING ARTIFACTS: CALCIUM POST SEGMENT ===

=== FILTERING SIMULTANEOUS EVENTS: CALCIUM POST SEGMENT ===
FIXED: Using per-channel baselines + fixed STD threshold for calcium visualization...
  Fixed calcium std: 0.0600
  Fixed calcium threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED calcium plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/post_calcium_unknown_20250128_slip1_area5_events_perchannel_fixed.png
Enhanced filtered calcium events saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip1_area5/events_calcium_unknown_20250128_slip1_area5_fixed_std_adaptive_filtered.csv

FIXED STD CALCIUM Event Summary for unknown 20250128_slip1_area5:
  Total filtered events: 3
  Total excluded events: 0 (50% rule)
  Pre-segment events: 3
  Post-segment events: 0
  Duration stats: mean=15.40s, median=14.20s
✓ Pipeline completed for 20250128_slip1_area5
1 2
1 3
1 4
1 5
1 6
1 7
1 8
1 9
1 10
1 11
1 12
1 13
1 14
1 15
1 16
1 17
1 18
1 19
1 20
1 21
1 22
1 23
1 24
1 25
1 26
1 27
1 28
1 29
1 30
1 31
1 32
1 33
1 34
1 35
1 36
1 37
1 38
1 39
1 40
1 41
1 42
1 43
1 44
1 45
1 46
1 47
1 48
1 49
1 50
1 51
1 52
1 53
1 54
1 55
1 56
1 57
1 58
1 59
1 60
1 61
1 62
1 63
1 64
1 65
1 66
1 67
1 68

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        64            32
 Used       :        16 (peak)  27.86 (ave)

============================================
