Original path: /rds/general/user/be320/projects/thefarm2/live/Firefly/Calcium_Voltage_Imaging/MDA_MB_468/20250127/slip3/20250127_slip3_area1_468/20250127_slip3_area1_exp3ms_4AP_5mM_1
Fixed path: /rds/general/user/ys5320/projects/thefarm2/live/Firefly/Calcium_Voltage_Imaging/MDA_MB_468/20250127/slip3/20250127_slip3_area1_468/20250127_slip3_area1_exp3ms_4AP_5mM_1
2 0
2 1
20250128_slip2_area4
['20250128_slip2_area4_roomtemp_4AP_5mM_1_MMStack_Default.ome.tif', '20250128_slip2_area4_roomtemp_4AP_5mM_1_MMStack_Default_1.ome.tif', '20250128_slip2_area4_roomtemp_4AP_5mM_1_MMStack_Default_2.ome.tif']
Loaded Z-stack shape: (20000, 512, 512)
(10000, 512, 512) (10000, 512, 512)
(10000, 512, 512) (10000, 512, 512)
✅ Saved enhanced_voltage_video.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250128_slip2_area4
✅ Saved enhanced_calcium_video.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250128_slip2_area4
2 3
2 4
2 5
2 6
2 7
2 8
2 9
2 10
2 11
2 12
2 13
2 14
2 15
2 16
2 17
2 18
2 19
2 20
2 21
2 22
2 23
2 24
2 25
2 26
2 27
2 28
2 29
2 30
2 31
2 32
2 33
2 34
2 35
2 36
2 37
2 38
2 39
2 40
2 41
2 42
2 43
2 44
2 45
2 46
2 47
2 48
2 49
2 50
2 51
2 52
2 53
2 54
2 55
2 56
2 57
2 58
2 59
2 60
2 61
2 62
2 63
2 64
2 65
2 66
2 67
2 68
2 0
2 1

Processing pipeline for trial: 20250128_slip2_area4
Processing trial: 20250128_slip2_area4
Voltage file: 20250128_slip2_area4_roomtemp_4AP_5mM_voltage_transfected.csv
Calcium file: 20250128_slip2_area4_roomtemp_4AP_5mM_ca_transfected.csv
--------------------------------------------------------------------------------
Loading voltage and calcium data...
Detected: full_experiment with 10000 datapoints
Detected: full_experiment with 10000 datapoints
Voltage cells: 12, Calcium cells: 12
=== FULL EXPERIMENT - USING SEGMENTATION ===
=== STEP 1: Normalization + High-Pass Filter to Full VOLTAGE Timeseries ===
Applying normalization to raw voltage data (before filtering)...
  - Min-max normalization applied to voltage (range: [-1, 1])
Applying high-pass filter to normalized voltage data (cutoff: 0.01 Hz)...
Normalization + High-pass filtering complete for voltage. Shape: (12, 10000)
=== STEP 1: Normalization + High-Pass Filter to Full CALCIUM Timeseries ===
Applying normalization to raw calcium data (before filtering)...
  - Min-max normalization applied to calcium (range: [-1, 1])
Applying high-pass filter to normalized calcium data (cutoff: 0.01 Hz)...
Normalization + High-pass filtering complete for calcium. Shape: (12, 10000)
=== STEP 2: Finding Consensus Timepoint from VOLTAGE data ===

=== Detection Consistency Analysis ===

Detection Consistency Analysis:
Total detections: 12
Time range: 16.71 - 16.76 min
Time span: 0.04 min
Standard deviation: 0.012 min
Median: 16.73 min

Detection time distribution (30-second bins):
  16.7-17.2 min: 12 detections

=== Consensus Timepoint (MODE) ===
Found 12 total detections across channels
Detection times: ['16.73 min', '16.74 min', '16.73 min', '16.72 min', '16.72 min', '16.71 min', '16.76 min', '16.73 min', '16.73 min', '16.74 min', '16.75 min', '16.74 min']
Consensus method: Mode group size = 12, time = 16.73 min

Consensus timepoint: 16.73 min (sample 5020)
Assigned consensus timepoint to all 12 channels
=== CREATING SEGMENT VIDEOS FOR 20250128_slip2_area4 ===
  Using TIFF files: ['20250128_slip2_area4_roomtemp_4AP_5mM_1_MMStack_Default.ome.tif', '20250128_slip2_area4_roomtemp_4AP_5mM_1_MMStack_Default_1.ome.tif', '20250128_slip2_area4_roomtemp_4AP_5mM_1_MMStack_Default_2.ome.tif']
  Loaded Z-stack shape: (20000, 512, 512)
  Deinterleaved shapes: V=(10000, 512, 512), Ca=(10000, 512, 512)
  Creating pre segment: frames 200-4820
✅ Saved pre_voltage_20250128_slip2_area4.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip2_area4
✅ Saved pre_calcium_20250128_slip2_area4.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip2_area4
  ✓ Created: pre_voltage_20250128_slip2_area4.avi & pre_calcium_20250128_slip2_area4.avi
  Creating post segment: frames 5420-9999
✅ Saved post_voltage_20250128_slip2_area4.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip2_area4
✅ Saved post_calcium_20250128_slip2_area4.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip2_area4
  ✓ Created: post_voltage_20250128_slip2_area4.avi & post_calcium_20250128_slip2_area4.avi
=== STEP 3: Segmenting High-Pass Filtered VOLTAGE Timeseries ===
Consensus timepoint: 5020 frames (16.73 min)
VOLTAGE PRE segment: frames 200-4820 (0.67-16.07 min)
  Shape: (12, 4621)
VOLTAGE POST segment: frames 5420-9999 (18.07-33.33 min)
  Shape: (12, 4580)
=== STEP 3: Segmenting High-Pass Filtered CALCIUM Timeseries ===
Consensus timepoint: 5020 frames (16.73 min)
CALCIUM PRE segment: frames 200-4820 (0.67-16.07 min)
  Shape: (12, 4621)
CALCIUM POST segment: frames 5420-9999 (18.07-33.33 min)
  Shape: (12, 4580)

=== PROCESSING VOLTAGE PRE SEGMENT ===
  - voltage Gaussian filtering applied (sigma=3)
  Voltage data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip2_area4/pre_voltage_unknown_20250128_slip2_area4.csv
  Voltage RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip2_area4/pre_voltage_unknown_20250128_slip2_area4_raw.csv

=== PROCESSING CALCIUM PRE SEGMENT ===
  - calcium Gaussian filtering applied (sigma=3)
  Calcium data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip2_area4/pre_calcium_unknown_20250128_slip2_area4.csv
  Calcium RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip2_area4/pre_calcium_unknown_20250128_slip2_area4_raw.csv

=== PROCESSING VOLTAGE POST SEGMENT ===
  - voltage Gaussian filtering applied (sigma=3)
  Voltage data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip2_area4/post_voltage_unknown_20250128_slip2_area4.csv
  Voltage RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip2_area4/post_voltage_unknown_20250128_slip2_area4_raw.csv

=== PROCESSING CALCIUM POST SEGMENT ===
  - calcium Gaussian filtering applied (sigma=3)
  Calcium data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip2_area4/post_calcium_unknown_20250128_slip2_area4.csv
  Calcium RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip2_area4/post_calcium_unknown_20250128_slip2_area4_raw.csv

=== VOLTAGE EVENT DETECTION ===
Using FIXED STD voltage event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting voltage events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
Detected 91 voltage events using fixed_std (fixed=0.0600)
  Removed 2 duplicate voltage events

=== FILTERING BLEACHING ARTIFACTS: VOLTAGE PRE SEGMENT ===
Filtering bleaching artifacts for voltage (≥5 cells, 70% overlap, start <10.0s)...
  Original voltage events: 89
  Excluded bleaching artifacts: 0
  Remaining voltage events: 89

=== FILTERING SIMULTANEOUS EVENTS: VOLTAGE PRE SEGMENT ===
Filtering simultaneous voltage events (max 999 cells, 50% overlap)...
  Original voltage events: 89
  Filtered voltage events: 89
  Excluded voltage events: 0
FIXED: Using per-channel baselines + fixed STD threshold for voltage visualization...
  Fixed voltage std: 0.0600
  Fixed voltage threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED voltage plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/pre_voltage_unknown_20250128_slip2_area4_events_perchannel_fixed.png
Using FIXED STD voltage event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting voltage events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
Detected 0 voltage events using fixed_std (fixed=0.0600)

=== FILTERING BLEACHING ARTIFACTS: VOLTAGE POST SEGMENT ===

=== FILTERING SIMULTANEOUS EVENTS: VOLTAGE POST SEGMENT ===
FIXED: Using per-channel baselines + fixed STD threshold for voltage visualization...
  Fixed voltage std: 0.0600
  Fixed voltage threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED voltage plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/post_voltage_unknown_20250128_slip2_area4_events_perchannel_fixed.png
Enhanced filtered voltage events saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip2_area4/events_voltage_unknown_20250128_slip2_area4_fixed_std_adaptive_filtered.csv

FIXED STD VOLTAGE Event Summary for unknown 20250128_slip2_area4:
  Total filtered events: 89
  Total excluded events: 0 (50% rule)
  Pre-segment events: 89
  Post-segment events: 0
  Duration stats: mean=27.56s, median=25.20s

=== CALCIUM EVENT DETECTION ===
Using FIXED STD calcium event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting calcium events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
Detected 61 calcium events using fixed_std (fixed=0.0600)
  Removed 5 duplicate calcium events

=== FILTERING BLEACHING ARTIFACTS: CALCIUM PRE SEGMENT ===
Filtering bleaching artifacts for calcium (≥5 cells, 70% overlap, start <10.0s)...
  Original calcium events: 56
  Excluded bleaching artifacts: 0
  Remaining calcium events: 56

=== FILTERING SIMULTANEOUS EVENTS: CALCIUM PRE SEGMENT ===
Filtering simultaneous calcium events (max 999 cells, 50% overlap)...
  Original calcium events: 56
  Filtered calcium events: 56
  Excluded calcium events: 0
FIXED: Using per-channel baselines + fixed STD threshold for calcium visualization...
  Fixed calcium std: 0.0600
  Fixed calcium threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED calcium plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/pre_calcium_unknown_20250128_slip2_area4_events_perchannel_fixed.png
Using FIXED STD calcium event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting calcium events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
Detected 0 calcium events using fixed_std (fixed=0.0600)

=== FILTERING BLEACHING ARTIFACTS: CALCIUM POST SEGMENT ===

=== FILTERING SIMULTANEOUS EVENTS: CALCIUM POST SEGMENT ===
FIXED: Using per-channel baselines + fixed STD threshold for calcium visualization...
  Fixed calcium std: 0.0600
  Fixed calcium threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED calcium plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/post_calcium_unknown_20250128_slip2_area4_events_perchannel_fixed.png
Enhanced filtered calcium events saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250128_slip2_area4/events_calcium_unknown_20250128_slip2_area4_fixed_std_adaptive_filtered.csv

FIXED STD CALCIUM Event Summary for unknown 20250128_slip2_area4:
  Total filtered events: 56
  Total excluded events: 0 (50% rule)
  Pre-segment events: 56
  Post-segment events: 0
  Duration stats: mean=19.36s, median=17.30s
✓ Pipeline completed for 20250128_slip2_area4
2 3
2 4
2 5
2 6
2 7
2 8
2 9
2 10
2 11
2 12
2 13
2 14
2 15
2 16
2 17
2 18
2 19
2 20
2 21
2 22
2 23
2 24
2 25
2 26
2 27
2 28
2 29
2 30
2 31
2 32
2 33
2 34
2 35
2 36
2 37
2 38
2 39
2 40
2 41
2 42
2 43
2 44
2 45
2 46
2 47
2 48
2 49
2 50
2 51
2 52
2 53
2 54
2 55
2 56
2 57
2 58
2 59
2 60
2 61
2 62
2 63
2 64
2 65
2 66
2 67
2 68

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        64            32
 Used       :        16 (peak)  27.02 (ave)

============================================
