Original path: /rds/general/user/be320/projects/thefarm2/live/Firefly/Calcium_Voltage_Imaging/MDA_MB_468/20250226/slip1/area1/20250226_slip1_area1_A01_50uM_1
Fixed path: /rds/general/user/ys5320/projects/thefarm2/live/Firefly/Calcium_Voltage_Imaging/MDA_MB_468/20250226/slip1/area1/20250226_slip1_area1_A01_50uM_1
10 0
10 1
10 2
10 3
10 4
10 5
10 6
10 7
10 8
10 9
20250327_slip1_area3
['20250327_slip1_area3_condition_o_1_MMStack_Default.ome.tif', '20250327_slip1_area3_condition_o_1_MMStack_Default_1.ome.tif']
Loaded Z-stack shape: (10000, 512, 512)
(5000, 512, 512) (5000, 512, 512)
(5000, 512, 512) (5000, 512, 512)
✅ Saved enhanced_voltage_video.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250327_slip1_area3
✅ Saved enhanced_calcium_video.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250327_slip1_area3
10 11
10 12
10 13
10 14
10 15
10 16
10 17
10 18
10 19
10 0
10 1
10 2
10 3
10 4
10 5
10 6
10 7
10 8
10 9

Processing pipeline for trial: 20250327_slip1_area3
Processing trial: 20250327_slip1_area3
Voltage file: 20250327_slip1_area3_condition_o_voltage_transfected.csv
Calcium file: 20250327_slip1_area3_condition_o_ca_transfected.csv
--------------------------------------------------------------------------------
Loading voltage and calcium data...
Detected: post_only with 5000 datapoints
Detected: post_only with 5000 datapoints
Voltage cells: 6, Calcium cells: 6
=== POST-ONLY FILES - SKIPPING SEGMENTATION ===
=== STEP 1: Normalization + High-Pass Filter to Full VOLTAGE Timeseries ===
Applying normalization to raw voltage data (before filtering)...
  - Min-max normalization applied to voltage (range: [-1, 1])
Applying high-pass filter to normalized voltage data (cutoff: 0.01 Hz)...
Normalization + High-pass filtering complete for voltage. Shape: (6, 5000)
=== STEP 1: Normalization + High-Pass Filter to Full CALCIUM Timeseries ===
Applying normalization to raw calcium data (before filtering)...
  - Min-max normalization applied to calcium (range: [-1, 1])
Applying high-pass filter to normalized calcium data (cutoff: 0.01 Hz)...
Normalization + High-pass filtering complete for calcium. Shape: (6, 5000)
  - voltage Gaussian filtering applied (sigma=3)
  Voltage data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250327_slip1_area3/post_voltage_unknown_20250327_slip1_area3.csv
  Voltage RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250327_slip1_area3/post_voltage_unknown_20250327_slip1_area3_raw.csv
  - calcium Gaussian filtering applied (sigma=3)
  Calcium data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250327_slip1_area3/post_calcium_unknown_20250327_slip1_area3.csv
  Calcium RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250327_slip1_area3/post_calcium_unknown_20250327_slip1_area3_raw.csv
=== CREATING POST-ONLY VIDEO ===
=== CREATING POST-ONLY VIDEOS FOR 20250327_slip1_area3 ===
  Using TIFF files: ['20250327_slip1_area3_condition_o_1_MMStack_Default.ome.tif', '20250327_slip1_area3_condition_o_1_MMStack_Default_1.ome.tif']
  Loaded Z-stack shape: (10000, 512, 512)
  Deinterleaved shapes: V=(5000, 512, 512), Ca=(5000, 512, 512)
  Creating post-only videos: entire recording (frames 0-4999)
✅ Saved post_voltage_20250327_slip1_area3.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250327_slip1_area3
✅ Saved post_calcium_20250327_slip1_area3.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250327_slip1_area3
  ✓ Created post-only videos: post_voltage_20250327_slip1_area3.avi & post_calcium_20250327_slip1_area3.avi

=== VOLTAGE EVENT DETECTION ===
Using FIXED STD voltage event detection
Min duration: 1.0s, Threshold: 2.5σ
  Using provided fixed std: 0.0500
  Fixed threshold for all channels: ±0.1250
  Using per-channel median baselines with fixed STD threshold
Detecting voltage events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
Detected 24 voltage events using fixed_std (fixed=0.0500)

=== FILTERING BLEACHING ARTIFACTS: VOLTAGE POST SEGMENT ===
Filtering bleaching artifacts for voltage (≥5 cells, 70% overlap, start <10.0s)...
  Found 6 negative bleaching events (cells: [0, 5, 4, 3, 2, 1], times: 0.0-0.6s)
  Original voltage events: 24
  Excluded bleaching artifacts: 6
  Remaining voltage events: 18

=== FILTERING SIMULTANEOUS EVENTS: VOLTAGE POST SEGMENT ===
Filtering simultaneous voltage events (max 999 cells, 50% overlap)...
  Original voltage events: 18
  Filtered voltage events: 18
  Excluded voltage events: 0
FIXED: Using per-channel baselines + fixed STD threshold for voltage visualization...
  Fixed voltage std: 0.0500
  Fixed voltage threshold: ±0.1250
  Using per-channel baselines (as in detection)
  FIXED voltage plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/event_detection_plots/post_voltage_unknown_20250327_slip1_area3_events_perchannel_fixed.png
Enhanced filtered voltage events saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250327_slip1_area3/events_voltage_unknown_20250327_slip1_area3_fixed_std_adaptive_filtered.csv

FIXED STD VOLTAGE Event Summary for unknown 20250327_slip1_area3:
  Total filtered events: 18
  Total excluded events: 6 (50% rule)
  Pre-segment events: 0
  Post-segment events: 18
  Duration stats: mean=45.26s, median=49.50s

=== CALCIUM EVENT DETECTION ===
Using FIXED STD calcium event detection
Min duration: 1.0s, Threshold: 2.5σ
  Using provided fixed std: 0.0500
  Fixed threshold for all channels: ±0.1250
  Using per-channel median baselines with fixed STD threshold
Detecting calcium events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
Detected 285 calcium events using fixed_std (fixed=0.0500)

=== FILTERING BLEACHING ARTIFACTS: CALCIUM POST SEGMENT ===
Filtering bleaching artifacts for calcium (≥5 cells, 70% overlap, start <10.0s)...
  Found 13 negative bleaching events (cells: [0, 5, 5, 5, 4, 4, 4, 2, 2, 2, 2, 1, 0], times: 0.0-8.6s)
  Original calcium events: 285
  Excluded bleaching artifacts: 13
  Remaining calcium events: 272

=== FILTERING SIMULTANEOUS EVENTS: CALCIUM POST SEGMENT ===
Filtering simultaneous calcium events (max 999 cells, 50% overlap)...
  Original calcium events: 272
  Filtered calcium events: 272
  Excluded calcium events: 0
FIXED: Using per-channel baselines + fixed STD threshold for calcium visualization...
  Fixed calcium std: 0.0500
  Fixed calcium threshold: ±0.1250
  Using per-channel baselines (as in detection)
  FIXED calcium plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/event_detection_plots/post_calcium_unknown_20250327_slip1_area3_events_perchannel_fixed.png
Enhanced filtered calcium events saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250327_slip1_area3/events_calcium_unknown_20250327_slip1_area3_fixed_std_adaptive_filtered.csv

FIXED STD CALCIUM Event Summary for unknown 20250327_slip1_area3:
  Total filtered events: 272
  Total excluded events: 13 (50% rule)
  Pre-segment events: 0
  Post-segment events: 272
  Duration stats: mean=21.86s, median=22.80s
✓ Pipeline completed for 20250327_slip1_area3
10 11
10 12
10 13
10 14
10 15
10 16
10 17
10 18
10 19

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        64            32
 Used       :         8 (peak)  14.89 (ave)

============================================
