Original path: /rds/general/user/be320/projects/thefarm2/live/Firefly/Calcium_Voltage_Imaging/MDA_MB_468/20250127/slip3/20250127_slip3_area1_468/20250127_slip3_area1_exp3ms_4AP_5mM_1
Fixed path: /rds/general/user/ys5320/projects/thefarm2/live/Firefly/Calcium_Voltage_Imaging/MDA_MB_468/20250127/slip3/20250127_slip3_area1_468/20250127_slip3_area1_exp3ms_4AP_5mM_1
15 0
15 1
15 2
15 3
15 4
15 5
15 6
15 7
15 8
15 9
15 10
15 11
15 12
15 13
15 14
20250304_slip3_area1
['20250304_slip3_area1_Ca_free_post_1_MMStack_Default.ome.tif', '20250304_slip3_area1_Ca_free_post_1_MMStack_Default_1.ome.tif']
Loaded Z-stack shape: (10000, 512, 512)
(5000, 512, 512) (5000, 512, 512)
(5000, 512, 512) (5000, 512, 512)
✅ Saved enhanced_voltage_video.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250304_slip3_area1
✅ Saved enhanced_calcium_video.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_pipeline/20250304_slip3_area1
15 16
15 17
15 18
15 19
15 20
15 21
15 22
15 23
15 24
15 25
15 26
15 27
15 28
15 29
15 30
15 31
15 32
15 33
15 34
15 35
15 36
15 37
15 38
15 39
15 40
15 41
15 42
15 43
15 44
15 45
15 46
15 47
15 48
15 49
15 50
15 51
15 52
15 53
15 54
15 55
15 56
15 57
15 58
15 59
15 60
15 61
15 62
15 63
15 64
15 65
15 66
15 67
15 68
15 0
15 1
15 2
15 3
15 4
15 5
15 6
15 7
15 8
15 9
15 10
15 11
15 12
15 13
15 14

Processing pipeline for trial: 20250304_slip3_area1_post
Processing trial: 20250304_slip3_area1_post
Voltage file: 20250304_slip3_area1_Ca_free_post_voltage_transfected.csv
Calcium file: 20250304_slip3_area1_Ca_free_post_ca_transfected.csv
--------------------------------------------------------------------------------
Loading voltage and calcium data...
Detected: post_only with 5000 datapoints
Detected: post_only with 5000 datapoints
Voltage cells: 26, Calcium cells: 26
=== POST-ONLY FILES - SKIPPING SEGMENTATION ===
=== STEP 1: Normalization + High-Pass Filter to Full VOLTAGE Timeseries ===
Applying normalization to raw voltage data (before filtering)...
  - Min-max normalization applied to voltage (range: [-1, 1])
Applying high-pass filter to normalized voltage data (cutoff: 0.01 Hz)...
Normalization + High-pass filtering complete for voltage. Shape: (26, 5000)
=== STEP 1: Normalization + High-Pass Filter to Full CALCIUM Timeseries ===
Applying normalization to raw calcium data (before filtering)...
  - Min-max normalization applied to calcium (range: [-1, 1])
Applying high-pass filter to normalized calcium data (cutoff: 0.01 Hz)...
Normalization + High-pass filtering complete for calcium. Shape: (26, 5000)
  - voltage Gaussian filtering applied (sigma=3)
  Voltage data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip3_area1_post/post_voltage_unknown_20250304_slip3_area1_post.csv
  Voltage RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip3_area1_post/post_voltage_unknown_20250304_slip3_area1_post_raw.csv
  - calcium Gaussian filtering applied (sigma=3)
  Calcium data saved with original cell IDs to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip3_area1_post/post_calcium_unknown_20250304_slip3_area1_post.csv
  Calcium RAW data saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip3_area1_post/post_calcium_unknown_20250304_slip3_area1_post_raw.csv
=== CREATING POST-ONLY VIDEO ===
=== CREATING POST-ONLY VIDEOS FOR 20250304_slip3_area1_post ===
  Using TIFF files: ['20250304_slip3_area1_Ca_free_post_1_MMStack_Default.ome.tif', '20250304_slip3_area1_Ca_free_post_1_MMStack_Default_1.ome.tif']
  Loaded Z-stack shape: (10000, 512, 512)
  Deinterleaved shapes: V=(5000, 512, 512), Ca=(5000, 512, 512)
  Creating post-only videos: entire recording (frames 0-4999)
✅ Saved post_voltage_20250304_slip3_area1_post.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip3_area1_post
✅ Saved post_calcium_20250304_slip3_area1_post.avi at 1000 FPS in /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip3_area1_post
  ✓ Created post-only videos: post_voltage_20250304_slip3_area1_post.avi & post_calcium_20250304_slip3_area1_post.avi

=== VOLTAGE EVENT DETECTION ===
Using FIXED STD voltage event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting voltage events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
  - Applying full morphological filtering for voltage channel 12
  - Applying full morphological filtering for voltage channel 13
  - Applying full morphological filtering for voltage channel 14
  - Applying full morphological filtering for voltage channel 15
  - Applying full morphological filtering for voltage channel 16
  - Applying full morphological filtering for voltage channel 17
  - Applying full morphological filtering for voltage channel 18
  - Applying full morphological filtering for voltage channel 19
  - Applying full morphological filtering for voltage channel 20
  - Applying full morphological filtering for voltage channel 21
  - Applying full morphological filtering for voltage channel 22
  - Applying full morphological filtering for voltage channel 23
  - Applying full morphological filtering for voltage channel 24
  - Applying full morphological filtering for voltage channel 25
Detected 58 voltage events using fixed_std (fixed=0.0600)
  Removed 7 duplicate voltage events

=== FILTERING BLEACHING ARTIFACTS: VOLTAGE POST SEGMENT ===
Filtering bleaching artifacts for voltage (≥5 cells, 70% overlap, start <10.0s)...
  Found 26 negative bleaching events (cells: [0, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1], times: 0.0-0.0s)
  Original voltage events: 51
  Excluded bleaching artifacts: 26
  Remaining voltage events: 25

=== FILTERING SIMULTANEOUS EVENTS: VOLTAGE POST SEGMENT ===
Filtering simultaneous voltage events (max 999 cells, 50% overlap)...
  Original voltage events: 25
  Filtered voltage events: 25
  Excluded voltage events: 0
FIXED: Using per-channel baselines + fixed STD threshold for voltage visualization...
  Fixed voltage std: 0.0600
  Fixed voltage threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED voltage plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/post_voltage_unknown_20250304_slip3_area1_post_events_perchannel_fixed.png
Enhanced filtered voltage events saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip3_area1_post/events_voltage_unknown_20250304_slip3_area1_post_fixed_std_adaptive_filtered.csv

FIXED STD VOLTAGE Event Summary for unknown 20250304_slip3_area1_post:
  Total filtered events: 25
  Total excluded events: 26 (50% rule)
  Pre-segment events: 0
  Post-segment events: 25
  Duration stats: mean=43.08s, median=48.00s

=== CALCIUM EVENT DETECTION ===
Using FIXED STD calcium event detection
Min duration: 6.5s, Threshold: 2.5σ
  Using provided fixed std: 0.0600
  Fixed threshold for all channels: ±0.1500
  Using per-channel median baselines with fixed STD threshold
Detecting calcium events using fixed_std approach...
  - Applying full morphological filtering for voltage channel 0
  - Applying full morphological filtering for voltage channel 1
  - Applying full morphological filtering for voltage channel 2
  - Applying full morphological filtering for voltage channel 3
  - Applying full morphological filtering for voltage channel 4
  - Applying full morphological filtering for voltage channel 5
  - Applying full morphological filtering for voltage channel 6
  - Applying full morphological filtering for voltage channel 7
  - Applying full morphological filtering for voltage channel 8
  - Applying full morphological filtering for voltage channel 9
  - Applying full morphological filtering for voltage channel 10
  - Applying full morphological filtering for voltage channel 11
  - Applying full morphological filtering for voltage channel 12
  - Applying full morphological filtering for voltage channel 13
  - Applying full morphological filtering for voltage channel 14
  - Applying full morphological filtering for voltage channel 15
  - Applying full morphological filtering for voltage channel 16
  - Applying full morphological filtering for voltage channel 17
  - Applying full morphological filtering for voltage channel 18
  - Applying full morphological filtering for voltage channel 19
  - Applying full morphological filtering for voltage channel 20
  - Applying full morphological filtering for voltage channel 21
  - Applying full morphological filtering for voltage channel 22
  - Applying full morphological filtering for voltage channel 23
  - Applying full morphological filtering for voltage channel 24
  - Applying full morphological filtering for voltage channel 25
Detected 85 calcium events using fixed_std (fixed=0.0600)
  Removed 4 duplicate calcium events

=== FILTERING BLEACHING ARTIFACTS: CALCIUM POST SEGMENT ===
Filtering bleaching artifacts for calcium (≥5 cells, 70% overlap, start <10.0s)...
  Original calcium events: 81
  Excluded bleaching artifacts: 0
  Remaining calcium events: 81

=== FILTERING SIMULTANEOUS EVENTS: CALCIUM POST SEGMENT ===
Filtering simultaneous calcium events (max 999 cells, 50% overlap)...
  Original calcium events: 81
  Filtered calcium events: 81
  Excluded calcium events: 0
FIXED: Using per-channel baselines + fixed STD threshold for calcium visualization...
  Fixed calcium std: 0.0600
  Fixed calcium threshold: ±0.1500
  Using per-channel baselines (as in detection)
  FIXED calcium plot saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/event_detection_plots/post_calcium_unknown_20250304_slip3_area1_post_events_perchannel_fixed.png
Enhanced filtered calcium events saved to: /rds/general/user/ys5320/home/firefly_link/Calcium_Voltage_Imaging/MDA_MB_468/analysis/results_profiles/20250304_slip3_area1_post/events_calcium_unknown_20250304_slip3_area1_post_fixed_std_adaptive_filtered.csv

FIXED STD CALCIUM Event Summary for unknown 20250304_slip3_area1_post:
  Total filtered events: 81
  Total excluded events: 0 (50% rule)
  Pre-segment events: 0
  Post-segment events: 81
  Duration stats: mean=24.53s, median=23.40s
✓ Pipeline completed for 20250304_slip3_area1
15 16
15 17
15 18
15 19
15 20
15 21
15 22
15 23
15 24
15 25
15 26
15 27
15 28
15 29
15 30
15 31
15 32
15 33
15 34
15 35
15 36
15 37
15 38
15 39
15 40
15 41
15 42
15 43
15 44
15 45
15 46
15 47
15 48
15 49
15 50
15 51
15 52
15 53
15 54
15 55
15 56
15 57
15 58
15 59
15 60
15 61
15 62
15 63
15 64
15 65
15 66
15 67
15 68

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        64            32
 Used       :         8 (peak)  18.85 (ave)

============================================
